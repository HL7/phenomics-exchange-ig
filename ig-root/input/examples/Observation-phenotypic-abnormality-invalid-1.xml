<?xml version="1.0" encoding="UTF-8"?>

<Observation xmlns="http://hl7.org/fhir" xmlns:h="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://hl7.org/fhir http://hl7.org/fhir/R4/fhir-single.xsd http://www.w3.org/1999/xhtml http://hl7.org/fhir/R4/fhir-xhtml.xsd">
  <id value="phenotypic-abnormality-invalid-1" />
  <text>
    <status value="generated" />
    <h:div>
      <h:p>Some example text. This comes from the .txt.div element.</h:p>
    </h:div>
  </text>
  <extension url="http://github.com/phenopackets/core-ig/ig-tools/validation-error-count">
    <valueInteger value="4" />
  </extension>
  <status value="final" />

  <!-- This is the overall phenotypic abnormality -->
  <code>
    <coding>
      <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
      <code value="HP:0001249" />
      <display value="Intellectual disability" />
    </coding>
    <text value="Intellectual disability" />
  </code>

  <!-- it is present -->
  <valueBoolean value="true" />

  <!--  This is where we start the phenotypic feature/observatino components -->

  <!-- we can have 0-1 severity component -->
  <component>
    <code>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
        <code value="HP:0012824" />
        <display value="Severity" />
      </coding>
    </code>
    <valueCodeableConcept>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
        <code value="HP:0012825" />
        <display value="Mild" />
      </coding>
    </valueCodeableConcept>
  </component>

  <!-- an INVALID second severity component, this violates the cardinality constraint -->
  <component>
    <code>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
        <code value="HP:0012824" />
        <display value="Severity" />
      </coding>
    </code>
    <valueCodeableConcept>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
        <code value="HP:0012825" />
        <display value="Mild" />
      </coding>
    </valueCodeableConcept>
  </component>


  <!-- We can have 0-* clinical modifier component -->
  <component>
    <code>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
        <code value="HP:0012823" />
        <display value="Clinical modifier" />
      </coding>
    </code>
    <valueCodeableConcept>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
        <code value="HP:0410401" />
        <display value="Worse in evening" />
      </coding>
    </valueCodeableConcept>
  </component>

  <!-- A second clinical modifier, which is valid according to cardinality, but this entry has a code that is not in the ValueSet -->
  <!-- but is in the CodeSystem -->
  <component>
    <code>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
        <code value="HP:0012823" />
        <display value="Clinical modifier" />
      </coding>
    </code>
    <valueCodeableConcept>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
        <code value="HP:0031375" />
        <display value="Refractory" />
      </coding>
    </valueCodeableConcept>
  </component>

  <!-- A third clinical modifier, which is valid according to cardinality, but this entry has a code that is not in the ValueSet -->
  <!-- and is also not in the CodeSystem -->
  <component>
    <code>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
        <code value="HP:0012823" />
        <display value="Clinical modifier" />
      </coding>
    </code>
    <valueCodeableConcept>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
        <code value="HP:999999999" />
        <display value="Non existant modifier" />
      </coding>
    </valueCodeableConcept>
  </component>

  <!-- We can have 0-1 CodeableConcept onset component -->
  <component>
    <code>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
        <code value="HP:0003674" />
        <display value="Onset" />
      </coding>
    </code>
    <valueCodeableConcept>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
        <code value="HP:0003577" />
        <display value="Congenital onset" />
      </coding>
    </valueCodeableConcept>
  </component>

  <!-- We can have 0-1 Quantity onset component -->
  <component>
    <code>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/hpo" />
        <code value="HP:0003674" />
        <display value="Onset" />
      </coding>
    </code>
    <valueQuantity>
      <value value="0" />
      <unit value="Day" />
      <system value="http://some/unit/system" />
      <code value="Day" />
    </valueQuantity>
  </component>

  <!-- Some other unknown component -->
  <component>
    <code>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/OTHER" />
        <code value="OTHER" />
        <display value="Severity" />
      </coding>
    </code>
    <valueCodeableConcept>
      <coding>
        <system value="http://github.com/phenopackets/core-ig/CodeSystem/OTHER" />
        <code value="OTHERTHING" />
        <display value="Mild" />
      </coding>
    </valueCodeableConcept>
  </component>
</Observation>